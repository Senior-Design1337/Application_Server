import face_recognition
import os
import ast
import sys
import numpy as np
import re
import pickle



def getnparray(arr):
    return [np.array([float(item) for item in feature[1:-1].split()]) for feature in list(arr.values())]

def toNParray(stringarr):
    # return np.array(['1','2','43'])
    return np.array([float(item) for item in stringarr[1:-1].split()])

def getnparray_at(arr, indx):
    return np.array(list(arr.values())[indx][1:-1].split())

# if True:
try:

    regex = re.compile(r"/routes.*$")

    # print("hello life")
    # print(toNParray(sys.argv[1]))
    # # sys.stdout.flush()

    # for x in range(10):
    #     print ("1")

    # Needs to be inputted (SHOULD THEY BE PAIRED??????)
    # known_face_encodings = []
    # known_face_names = []


    # keys = known_face_names/IDs
    # values = known_face_encodings

    # # with open ('encodings', 'r') as f:
    # # set a dynamic absolute path since relative paths do not work in Nodejs (theory: paths are relative to the directory from which the server is running)
    # with open (regex.sub('/models/encodings', os.path.abspath(__file__)), 'r') as f:
    #     inputdata = f.read().replace('\n', '')
    #     known_data = ast.literal_eval(inputdata)#.replace(',', ''))
    #     # known_data = ast.literal_eval(inputdata)
    #     # known_data = ast.literal_eval(inputdata)

    data = pickle.loads(open(regex.sub('/models/new_encodings.pickle', os.path.abspath(__file__)), 'rb').read())

    # print(data)

    # known_data = data["encodings"]
    # print(os.path.abspath(__file__).rsplit('/',1))
    # print(inputdata)
    # sys.stdout.flush()

    # # inputdata2 = "{'Donald Trump': '[-0.09166827  0.14425197  0.04078295 -0.03495655 -0.09622052  0.04099583\n  0.02662841 -0.17784461  0.12904914 -0.1388557   0.18857408 -0.02269836\n -0.31221309 -0.10909825  0.05068425  0.11542154 -0.11377509 -0.12412596\n -0.18914004 -0.11264455 -0.02938333  0.04681868 -0.0251527  -0.04514992\n -0.08941696 -0.25926712 -0.10442628 -0.05142256  0.01757953 -0.08665138\n  0.0842521   0.06147777 -0.20893137 -0.08608527 -0.05323231  0.03884585\n -0.05924495 -0.04575182  0.07029408  0.03683743 -0.14352694 -0.04711682\n -0.02806153  0.23502387  0.23772253  0.01743989 -0.00103552 -0.09930864\n  0.09209329 -0.25414282 -0.02423913  0.10893594  0.04156319  0.1021982\n  0.05787547 -0.09143835  0.01682046  0.13410327 -0.16470394  0.0794233\n  0.04785687 -0.2341857  -0.0453307  -0.06419529  0.09106698  0.08091357\n -0.0099361  -0.13200559  0.22118577 -0.18348159 -0.13668175  0.05446102\n -0.06471929 -0.15043966 -0.3472513   0.00623041  0.37149131  0.18573408\n -0.15642616 -0.05463828 -0.04825759 -0.00336403  0.09292394  0.07982755\n  0.0016217  -0.12219425 -0.07368944  0.03052378  0.25506455 -0.07061901\n -0.0461551   0.24331255 -0.03288478 -0.03834173  0.02473532  0.03230941\n -0.05248236 -0.01390602 -0.09815697 -0.06522249  0.06731446 -0.14231357\n  0.00802742  0.08258242 -0.11984105  0.21042551  0.01114251  0.01666296\n -0.00154421 -0.11873214 -0.02308807  0.06714715  0.23481898 -0.16937561\n  0.25159791  0.23491265 -0.06884868  0.13148509  0.03437761  0.12037931\n -0.06310897 -0.08327458 -0.14112675 -0.16643775  0.02053617  0.02646331\n  0.01319711  0.01977976]', 'Abdulrahman Butchiri': '[-0.11250277  0.00145523  0.10736778 -0.06391846 -0.02635806 -0.00151397\n -0.04782222 -0.02319097  0.19918771 -0.05417177  0.21410055  0.00192218\n -0.13124254 -0.05715794 -0.03606566  0.09789494 -0.12227486 -0.08845802\n -0.0104512  -0.06175347 -0.0222502   0.05307741  0.02889668  0.04185274\n -0.11532311 -0.37991142 -0.06631988 -0.10586266  0.02894858 -0.05763315\n -0.01206042  0.1321515  -0.23332228 -0.08474366  0.00947708  0.12606356\n  0.00309852 -0.01257003  0.12250163  0.030635   -0.11152237 -0.04886398\n  0.04376108  0.26258376  0.10024345  0.10442856 -0.01409464 -0.05607186\n  0.05200034 -0.2290643   0.07236981  0.10629503  0.07081302  0.04650681\n  0.05323982 -0.08650152  0.07180533  0.03543156 -0.21896504  0.04671447\n  0.00611838  0.02896157  0.00114321 -0.02256753  0.22211258  0.12245569\n -0.04817649 -0.07902211  0.14054689 -0.13598022 -0.05302723  0.03821132\n -0.05776332 -0.17985688 -0.27351719  0.04381597  0.36901483  0.18072806\n -0.18039927  0.03321706 -0.09147881 -0.07489453  0.08403748  0.01175103\n -0.11557891  0.05732759 -0.0681152   0.01647668  0.19549936  0.06910425\n -0.03824607  0.18810458  0.02110538  0.02464404  0.04737009  0.03292944\n -0.07368677  0.02594528 -0.23303196 -0.07086364  0.0465089   0.03333253\n  0.00804879  0.13978024 -0.2254533   0.14561698  0.02756352 -0.11239941\n  0.04656506  0.0900391  -0.12160814 -0.10580368  0.13091055 -0.20642579\n  0.11114645  0.15928468  0.07858971  0.18358234  0.08570702  0.06011841\n -0.00956716 -0.05346587 -0.11772392 -0.07529216  0.07717717 -0.01902322\n  0.05281779  0.05313197]', 'Mr.Kabba': '[-0.06087902  0.09005798 -0.02578827 -0.03092698 -0.04752968 -0.0753973\n -0.05707112 -0.14066002  0.15809068 -0.06793404  0.26645875 -0.0507648\n -0.2351124  -0.03914846  0.07671973  0.06649696 -0.06828171 -0.06982129\n -0.22190809 -0.10791083 -0.04212687 -0.09687173  0.08890587  0.08981773\n -0.2200561  -0.28376612 -0.09494707 -0.11778406  0.08295673 -0.11531363\n -0.02738557  0.0395944  -0.16287521 -0.15554389  0.04323437 -0.00055281\n -0.01785043 -0.00237101  0.28217554 -0.06609224 -0.14053816  0.04929978\n  0.05682609  0.22736293  0.27181649  0.06247427  0.05090838 -0.05448774\n  0.11063746 -0.30930763  0.09000162  0.08045707  0.048367    0.04610011\n  0.17658517 -0.13875945 -0.03523937  0.16055393 -0.17167702  0.07948913\n  0.06895418 -0.02264867 -0.10504033 -0.083808    0.24070816  0.17632544\n -0.14147608 -0.08495884  0.10975242 -0.16237415  0.01791806  0.09889379\n -0.10989606 -0.15880099 -0.34566894  0.06615688  0.40714729  0.19324198\n -0.18780646  0.02083432 -0.04850781  0.00870921  0.08360393 -0.07850508\n -0.10127068 -0.09747602  0.00173575  0.05009964  0.17695367  0.04023642\n -0.05492133  0.17553765 -0.03031825  0.0332356   0.04545605  0.07009577\n -0.1417217  -0.13445255 -0.15479523  0.04686513  0.06504546 -0.01302361\n  0.07399199  0.08867127 -0.14568207  0.10929972 -0.04633906 -0.02441052\n  0.00318955  0.11244629 -0.11473766 -0.03222039  0.1448212  -0.31061736\n  0.20342813  0.1467869  -0.02846912  0.04708761  0.05689231  0.01227963\n  0.00915687  0.14847659 -0.08790993 -0.10616875  0.04231723 -0.04295176\n  0.10842822 -0.00299611]', 'Yusef': '[-0.07849491  0.03904608  0.0097245  -0.04991256 -0.10733964 -0.00200836\n -0.03602532 -0.07505538  0.24308465 -0.10752393  0.15647401 -0.01243265\n -0.18271726  0.02581534 -0.0264741   0.09339885 -0.07613924 -0.13926417\n -0.05458317 -0.09827141 -0.05362729  0.02326991 -0.05791694  0.05162711\n -0.10072351 -0.26248744 -0.07118616 -0.16690965 -0.02823735 -0.12094119\n -0.03363675  0.07649673 -0.18215546 -0.07648171 -0.00273842  0.06389125\n -0.05100023 -0.02709237  0.17530103  0.06262662 -0.1148106  -0.07412559\n  0.0766039   0.26694852  0.14866859  0.00900422  0.01591058 -0.06540996\n  0.14650878 -0.21084855  0.04522831  0.09822721  0.11383273  0.07408259\n  0.14708129 -0.13025269  0.06983057  0.04121453 -0.19156685  0.11350212\n  0.08043114  0.01368882 -0.06372299  0.02272443  0.2467072   0.10674602\n -0.01226455 -0.10660523  0.12301217 -0.17013423 -0.07458788  0.08827655\n -0.07869029 -0.21637391 -0.20851646  0.05600771  0.38575301  0.17694816\n -0.14345163  0.07992494 -0.00629684 -0.12510598  0.12816077  0.02188383\n -0.07991851  0.05561855 -0.07864597  0.0598454   0.23904961  0.00987224\n  0.01042201  0.16048989 -0.02798219 -0.04150798  0.0437512   0.03239502\n -0.09814478  0.00448499 -0.16955544 -0.09383369  0.10332721 -0.03226344\n -0.00191203  0.04324968 -0.19206697  0.07555412 -0.02582192 -0.08871259\n -0.09138286 -0.02090682 -0.1171243   0.00575142  0.17835879 -0.19514619\n  0.13331689  0.05709799 -0.02342691  0.11809375  0.02560183  0.01744243\n  0.00734078 -0.0514823  -0.09903534 -0.0795349   0.04957661  0.02884066\n  0.06678042  0.0119254 ]', 'Nouran': '[-0.14426     0.05385725  0.03002213 -0.08497845 -0.12384647 -0.04176642\n -0.00306021 -0.03513998  0.19752134 -0.13695809  0.20320624  0.00934933\n -0.24508932 -0.04044324  0.00949279  0.20204012 -0.13584578 -0.17841817\n -0.13072568 -0.05316425  0.03284812  0.02498841  0.03894944  0.10157978\n -0.13400096 -0.27180097 -0.02378773 -0.00347704 -0.0214767  -0.05850449\n  0.03716251  0.17367265 -0.09282856 -0.01526478  0.02496195  0.14412513\n -0.02930099 -0.09407677  0.29128629  0.02996862 -0.27476767 -0.07780141\n  0.15268378  0.28629524  0.23334461  0.01803859  0.05280818 -0.04969975\n  0.08185937 -0.34573159  0.06731001  0.17232715  0.08728147  0.09582724\n  0.13210611 -0.16853905  0.00539115  0.11588163 -0.17961574 -0.01838824\n  0.01237739 -0.04969456 -0.01024208 -0.13121754  0.28072175  0.16024336\n -0.14015098 -0.12683198  0.25950918 -0.16718879 -0.20088565  0.13672763\n -0.12863389 -0.15792033 -0.32281199 -0.05191082  0.29466045  0.19302928\n -0.10064568  0.0615763  -0.05368595 -0.07785106 -0.03034309  0.13881996\n -0.01794504 -0.02443706 -0.03868365 -0.00183272  0.22386858  0.01969896\n -0.05915076  0.2456072   0.13687357 -0.08113242 -0.00446925  0.09260626\n -0.01470532 -0.01121115 -0.20161992 -0.04170351  0.03934315 -0.01675601\n  0.04535578  0.10742974 -0.22198671  0.1392749  -0.01309795 -0.00405799\n -0.02017092  0.04500131 -0.08550144 -0.00608897  0.11153285 -0.28255504\n  0.143732    0.16737536  0.03060615  0.10992742  0.08122413  0.11327731\n  0.05582544 -0.08950856 -0.11280014 -0.11465643  0.0238819  -0.00141208\n  0.06198153  0.16979545]', 'Abdo': '[-5.02297580e-02  1.26760080e-01  3.77465747e-02 -2.10738834e-02\n -9.86030772e-02 -3.23209167e-03 -3.80280092e-02 -8.08492303e-02\n  1.28862917e-01 -1.20417327e-01  8.24542195e-02 -1.01172492e-01\n -1.74008071e-01  3.29966657e-02 -3.06838341e-02  1.27440408e-01\n -1.97433874e-01 -6.67174160e-02 -1.28294557e-01 -1.14508331e-01\n  6.80248067e-02  1.14857338e-01 -2.19074786e-02  8.76902044e-03\n -1.70026362e-01 -3.26539963e-01 -9.22631770e-02 -1.50439903e-01\n  5.18140458e-02 -7.32299984e-02 -4.99619544e-02 -4.58791927e-02\n -1.61716744e-01 -1.67583600e-02  6.50386810e-02  2.09987164e-04\n -5.70341274e-02 -5.61766848e-02  8.86950791e-02  3.83684486e-02\n -1.08378172e-01  2.83726454e-02  7.65267909e-02  2.80950844e-01\n  1.24665245e-01  1.15483917e-01 -1.78522021e-02 -1.07932150e-01\n  1.29320234e-01 -2.20598400e-01  1.54873222e-01  7.27170333e-02\n  3.19188982e-02  1.24173850e-01  1.37470573e-01 -1.67170733e-01\n  6.39430881e-02  6.40481412e-02 -2.40873784e-01  1.51794732e-01\n  1.20433882e-01 -1.30222552e-02 -4.13024500e-02  1.78492963e-02\n  2.42216825e-01  1.44766659e-01 -9.55065861e-02 -1.02297872e-01\n  1.43553019e-01 -1.78445071e-01  3.86314467e-03 -5.85360192e-02\n -5.43066412e-02 -1.65239275e-01 -2.25232199e-01  3.68878394e-02\n  5.13320625e-01  2.15302616e-01 -1.89862788e-01 -2.17002872e-02\n -4.64821719e-02 -4.36704159e-02  2.10187718e-01  1.00420259e-01\n -1.06857866e-01 -1.66975409e-02 -2.87751760e-02  1.38402939e-01\n  1.78730458e-01 -4.93616611e-02 -5.98646328e-02  2.49440044e-01\n  3.64733487e-03 -1.65851563e-02  1.36605231e-02 -5.35424501e-02\n -1.84895724e-01 -1.48202106e-02 -9.82353017e-02 -3.83635387e-02\n  6.42992556e-02 -5.82239330e-02 -1.50630325e-02  1.34881467e-01\n -1.34747371e-01  1.91140115e-01  4.59303483e-02 -7.40733445e-02\n -2.92570740e-02  4.87168878e-02 -1.71608478e-01 -3.60082686e-02\n  1.36685371e-01 -2.06164867e-01  2.09368780e-01  1.28074378e-01\n  7.60017484e-02  1.76120102e-01  2.20122114e-02  4.47442606e-02\n  8.90297517e-02 -6.84083998e-03 -1.69876680e-01 -5.69036454e-02\n  7.57844597e-02 -5.72012365e-03  5.06599396e-02  3.85830402e-02]', 'Zeina': '[-1.68953970e-01  1.20235749e-01  1.09173030e-01 -9.23958421e-02\n -1.45955816e-01 -2.57076696e-02 -2.76765116e-02 -7.46114999e-02\n  2.35725120e-01 -1.13472015e-01  1.42571613e-01  4.18062173e-02\n -2.15515569e-01  1.02080435e-01 -7.36301020e-02  1.87113047e-01\n -1.69584557e-01 -1.81872457e-01 -9.15173069e-03 -1.95148736e-02\n -1.97083652e-02  3.95229794e-02  2.57627778e-02  7.88697451e-02\n -1.13792427e-01 -3.17359269e-01 -8.09976086e-02 -5.43308705e-02\n  2.68744640e-02 -9.17159021e-03  4.67242934e-02  7.28205889e-02\n -1.90192580e-01 -3.58521938e-04  3.01463529e-02  1.20248154e-01\n -1.09364510e-01 -1.83905691e-01  2.37525493e-01  8.55344832e-02\n -2.31890500e-01 -7.70476311e-02  5.83461598e-02  2.92817891e-01\n  2.03081340e-01 -3.50170508e-02  7.14977831e-02 -1.30143479e-01\n  1.65845737e-01 -2.94341356e-01  7.27156848e-02  1.66847661e-01\n  3.05614658e-02  1.14338078e-01  1.00032166e-01 -1.59088850e-01\n  1.22575283e-01  1.48385987e-01 -1.95980042e-01 -3.08784842e-03\n  8.71562213e-02  6.14985675e-02  6.90486431e-02 -6.10814542e-02\n  2.79316664e-01  1.47560284e-01 -8.34902376e-02 -1.02978364e-01\n  2.88106322e-01 -1.21132433e-01 -8.05966258e-02  8.06844532e-02\n -1.38220876e-01 -2.04135910e-01 -1.84414715e-01  4.98862863e-02\n  4.43886817e-01  2.43848145e-01 -6.55063912e-02  5.19411452e-02\n -6.44430220e-02 -7.69826546e-02  1.54460073e-02  1.69303343e-01\n -7.96860754e-02 -2.61450410e-02 -4.02786210e-02  8.55346024e-03\n  2.67482579e-01  6.19283542e-02 -4.00585905e-02  2.33212382e-01\n  8.18650723e-02 -5.06770834e-02  4.24502939e-02  2.17298418e-02\n -1.30407035e-01  2.55487263e-02 -2.18856901e-01 -1.03036277e-01\n -4.30802554e-02  1.18650869e-02 -9.89139080e-04  2.02151641e-01\n -1.96050256e-01  1.85991317e-01 -7.62471557e-03 -4.73870933e-02\n -4.33686450e-02  3.20911109e-02 -5.06099723e-02 -2.61492878e-02\n  9.74009112e-02 -1.73897326e-01  1.72114223e-01  8.46631601e-02\n  5.40841445e-02  1.41311869e-01  6.63695857e-02  8.85675922e-02\n  4.20025662e-02 -6.39657676e-02 -1.35614663e-01 -6.06256351e-02\n  6.51687831e-02 -2.82890946e-02  5.32825291e-02  7.47451186e-02]', 'Vladimir Putin': '[-5.42903394e-02  1.48295313e-01  8.75957385e-02 -3.66203412e-02\n -1.22272544e-01  8.57783109e-03 -7.90667161e-02 -6.86410964e-02\n  7.23895431e-02 -1.21370656e-02  1.82794079e-01 -5.63803427e-02\n -3.00564289e-01  6.88893348e-02 -5.44295609e-02  8.66441578e-02\n -1.64868087e-01 -7.92431831e-02 -1.34390816e-01 -1.68923199e-01\n -2.29238346e-03  8.86606872e-02  9.22236964e-03 -5.31185307e-02\n -8.56214315e-02 -2.93151408e-01 -1.86388940e-02 -4.17992286e-02\n  8.64680484e-02 -1.00265428e-01  5.82512915e-02 -3.01336125e-02\n -1.81280822e-01 -3.19075510e-02 -1.85236335e-04  3.21564730e-03\n -6.87708855e-02 -8.18061978e-02  2.72128731e-01 -3.20401527e-02\n -1.41324162e-01  2.05433965e-02  7.71116838e-02  2.19874278e-01\n  1.63217455e-01  2.15553641e-02  1.90223232e-02 -1.05075344e-01\n  6.55592531e-02 -1.67879432e-01  5.92430606e-02  2.59636343e-01\n  7.81550258e-02  1.00096568e-01 -4.45660949e-03 -1.26234919e-01\n -1.98259950e-03  1.30973071e-01 -1.45774364e-01 -1.88022926e-02\n  1.18051842e-01 -2.70478278e-02 -4.49347161e-02 -2.83527523e-02\n  1.93435445e-01  5.45056164e-02 -8.03515464e-02 -1.63444266e-01\n  1.96072102e-01 -1.08448103e-01 -1.17949441e-01 -2.51046345e-02\n -8.30935314e-02 -8.71439949e-02 -2.39645168e-01  6.39812201e-02\n  3.50506276e-01  1.53147765e-02 -1.80768400e-01  7.22955465e-02\n -1.00088485e-01 -9.28590745e-02  2.71264687e-02  4.19695824e-02\n -1.20839551e-01 -4.37587947e-02 -4.40819301e-02  6.31760657e-02\n  1.74869820e-01 -4.06730101e-02 -1.05614290e-02  1.32435575e-01\n  8.63268226e-02 -2.63456032e-02  1.04492053e-01  1.24239802e-01\n -1.51515603e-01  1.29010975e-02 -1.34989828e-01  9.92794335e-03\n  1.09847143e-01 -9.66735855e-02  1.69335306e-02  1.44504145e-01\n -1.85516208e-01  2.51616210e-01  3.29255909e-02 -5.86415678e-02\n  3.64756808e-02  1.77417547e-02 -1.41603127e-02 -6.81795031e-02\n  2.09428877e-01 -2.05233172e-01  2.13020787e-01  1.39771715e-01\n -8.52391124e-03  1.45006210e-01  9.20443311e-02  1.35665983e-01\n  1.51019692e-02  5.99944443e-02 -1.98793560e-01 -1.57205015e-01\n -3.02873105e-02  2.17851996e-02  2.58056819e-03  1.21568128e-01]', 'Saad Bashar': '[-0.14709483  0.12558214  0.10043681 -0.0459514  -0.06040671 -0.03463138\n -0.03815551 -0.14539243  0.14252329 -0.16962829  0.1875788  -0.07453668\n -0.20647901 -0.07001868 -0.04160138  0.108709   -0.13612686 -0.15488912\n -0.02117576 -0.05039515  0.06196183 -0.06872903  0.01264423  0.05986782\n -0.13132587 -0.38918543 -0.11690944 -0.09962872 -0.01057095 -0.07255831\n -0.02733929  0.00257949 -0.18465868 -0.02604616 -0.0734736   0.09297233\n  0.00623646 -0.01655135  0.14054388 -0.06698819 -0.18889183 -0.07296202\n  0.05384391  0.22693729  0.1547958   0.0959827   0.02500639  0.00750902\n  0.07051633 -0.24514504  0.03595233  0.07827808  0.09068397 -0.00840529\n  0.0921021  -0.14084128 -0.00164106  0.02995986 -0.09945607  0.08373636\n  0.02633253 -0.08134917 -0.02091314  0.0157194   0.25110841  0.11460961\n -0.08716413 -0.07015514  0.15844633 -0.20887123 -0.02331748  0.03411664\n -0.08533259 -0.18342885 -0.30523837  0.01024142  0.42138404  0.17737538\n -0.14053907  0.00837082 -0.05276658  0.01755334  0.13138716  0.06815308\n -0.11394875  0.07134401 -0.15334117  0.05922826  0.23537563 -0.01282186\n -0.07583119  0.2002679  -0.03989329  0.09109423 -0.00105753 -0.00468615\n -0.0675846  -0.00598012 -0.14758472  0.00975413  0.11511478 -0.00349704\n -0.04044265  0.12835263 -0.16908517  0.04261503 -0.03578705 -0.02269726\n -0.03729694  0.06643564 -0.19593152 -0.05462778  0.15018411 -0.17976543\n  0.1076984   0.23284262 -0.00719661  0.11086035  0.14671713 -0.02514677\n  0.07246047 -0.05100299 -0.15312009 -0.06971886  0.09322786 -0.07049886\n  0.09654349  0.01033522]', 'Wasif': '[-0.11020377  0.08143705  0.02745957 -0.08404807 -0.02078536 -0.05064313\n  0.02416577 -0.00253212  0.15936488 -0.03893916  0.17936096 -0.00577052\n -0.25318983 -0.07547637 -0.02590067  0.10136661 -0.14284816 -0.15140793\n -0.09383287 -0.022623    0.07129369 -0.0168891  -0.00600531  0.03210676\n -0.11996543 -0.31473818 -0.09511113 -0.08361723 -0.05764291 -0.17023337\n  0.02429348  0.01167765 -0.22822464 -0.1130191  -0.04798549  0.01906421\n -0.01038571 -0.07408943  0.17526956  0.01908872 -0.19512109 -0.03561358\n  0.07832655  0.30159253  0.14570096  0.01792102 -0.07076031  0.03341809\n  0.0371035  -0.26901513  0.08632705  0.11045148  0.11930794  0.05162234\n  0.06846397 -0.07293983  0.03306744  0.10936236 -0.23268117 -0.00181888\n  0.04258148 -0.05839106  0.00453613 -0.07390521  0.16756725  0.09030976\n -0.1033321  -0.05334505  0.07329758 -0.1389782   0.02458361  0.02222395\n -0.06773616 -0.19244096 -0.25978425  0.10496548  0.34115255  0.15651006\n -0.11922769  0.01488811 -0.09195779 -0.0866165   0.02757384 -0.0039285\n -0.08758328  0.0698872  -0.08599484  0.08761692  0.14674741  0.02914241\n -0.02728844  0.18153214 -0.03483395 -0.05307417  0.04692004  0.02226237\n -0.08333053  0.01600254 -0.13992099  0.06566277  0.00531043 -0.11657019\n -0.03574393  0.10094602 -0.12141879  0.03054802  0.04561121 -0.08738404\n -0.04740559  0.03868748 -0.14784874 -0.1379855   0.08381082 -0.20561831\n  0.11968197  0.15863828 -0.01271585  0.11030944  0.05007507  0.05294567\n -0.01291013 -0.02146359 -0.12621848 -0.03872576  0.12405623  0.03242053\n  0.11609417  0.00639101]', 'Jerry': '[-0.15864789  0.05057565  0.07106486 -0.08547209 -0.03611776 -0.0791272\n -0.00852855 -0.00464286  0.16163132 -0.07084133  0.20420921 -0.04995332\n -0.11785899 -0.0782299  -0.03686211  0.10344829 -0.1208915  -0.14255191\n -0.06116562 -0.09274346  0.08964408  0.01773312 -0.05599563  0.04339324\n -0.16409984 -0.31397668 -0.06589384 -0.09829438  0.04532787 -0.03109165\n  0.05546371  0.12000385 -0.19880548 -0.07156917  0.02597523  0.13894542\n -0.0195369   0.05398107  0.11920973  0.04353416 -0.1247184  -0.00294097\n  0.04343895  0.29821205  0.17067304  0.13138434  0.00181808 -0.03916903\n  0.09226903 -0.22022203  0.05573218  0.116233    0.1382096   0.07177958\n  0.15077698 -0.10901208  0.06557626  0.03356662 -0.23410055  0.07834847\n -0.01309658 -0.04719773 -0.05579371 -0.0808116   0.18914719  0.07812869\n -0.08872162 -0.08787854  0.21447089 -0.13180348 -0.04379995  0.12497083\n -0.06863728 -0.14595193 -0.23551954  0.05892842  0.42547804  0.15891784\n -0.16386542  0.03830679  0.03340954 -0.06382492  0.08554542  0.04550329\n -0.10976863  0.0137028  -0.05674279  0.0430724   0.13319387  0.03205803\n -0.05200417  0.14809951 -0.0181279   0.04659032  0.01464256 -0.00785503\n -0.08758502  0.04524169 -0.12680368 -0.07059912  0.08387257 -0.02395929\n -0.01054111  0.06679825 -0.08814681  0.14332642 -0.01585434 -0.00762518\n -0.08209381  0.07595199 -0.10508856 -0.00051992  0.10805216 -0.20079836\n  0.17427531  0.14931312 -0.02739482  0.10461837  0.08226395  0.02241852\n  0.02999924 -0.02637967 -0.14345682 -0.08557724  0.04816043 -0.06324672\n  0.08452122  0.01607271]', 'Lina': '[-1.13320790e-01  5.99919185e-02  1.01912037e-01 -9.79868174e-02\n -1.37918115e-01 -1.25356257e-01 -9.59892124e-02 -1.09047316e-01\n  1.21672720e-01 -1.80969924e-01  1.31855503e-01 -6.42207339e-02\n -2.09919930e-01  6.69633597e-03 -3.70346308e-02  1.92646146e-01\n -1.03301793e-01 -1.44515440e-01 -3.59872952e-02 -3.33348066e-02\n  9.09100696e-02 -4.77940589e-03 -2.44625397e-02  1.23189621e-01\n -1.86842054e-01 -3.51336747e-01 -7.76827186e-02 -1.37760118e-02\n -9.30472612e-02 -1.61053687e-02  2.38315649e-02  1.04333401e-01\n -1.93771034e-01 -4.01882380e-02  2.26076096e-02  1.51912868e-01\n -4.97195125e-03 -4.16111499e-02  1.05921924e-01  3.30800749e-02\n -3.12737405e-01 -1.18468106e-02  1.36545613e-01  2.11645812e-01\n  1.69337571e-01  4.40703109e-02  9.88050252e-02 -9.10699069e-02\n  9.90732014e-02 -2.65609294e-01 -5.22146141e-03  8.35601985e-02\n  1.71679836e-02  5.84661141e-02  4.24984246e-02 -2.11777002e-01\n  8.62407684e-02  8.40477794e-02 -2.14151636e-01  2.44325250e-02\n  1.10628068e-01 -7.46444836e-02 -5.56036606e-02 -1.64366961e-02\n  2.53758192e-01  1.32497668e-01 -1.32970676e-01 -1.32932305e-01\n  2.67425716e-01 -1.98920503e-01 -4.25514728e-02  8.88441876e-02\n -8.85048211e-02 -1.51995406e-01 -3.00516427e-01 -3.57526243e-02\n  4.50293720e-01  1.66124478e-01 -1.23334274e-01  4.81070727e-02\n -1.08019195e-01  4.77725826e-02  2.13571787e-02  1.01297095e-01\n -1.70414150e-02  6.16885424e-02 -5.70506640e-02  4.24749851e-02\n  2.09829748e-01  5.93545660e-02  1.25047639e-02  2.39220262e-01\n  1.02221370e-01  2.70452797e-02  5.90831414e-02  7.67075494e-02\n -1.77364767e-01 -3.91231701e-02 -1.84649616e-01 -4.95993048e-02\n -1.86323822e-02 -5.35870120e-02  2.99915224e-02  1.48043722e-01\n -2.25088343e-01  2.59421974e-01 -2.63485461e-02 -1.80331357e-02\n -3.28647271e-02  1.52568519e-01 -6.66954070e-02 -5.26863337e-02\n  8.62747207e-02 -1.92942768e-01  1.04667358e-01  1.81920201e-01\n  9.19478089e-02  1.36051133e-01  1.04311511e-01  8.08305591e-02\n -2.00107694e-04 -6.67533576e-02 -1.75649032e-01 -8.29864889e-02\n  2.52678245e-03 -1.21387199e-01  8.34049284e-02  7.01207146e-02]', 'Jayroop': '[-1.43703401e-01  5.86893708e-02  7.63671100e-02 -5.77694643e-03\n -3.46957967e-02 -6.17091805e-02 -4.63084951e-02 -3.49542312e-02\n  1.61160812e-01 -1.85313359e-01  1.93498775e-01 -5.10780811e-02\n -1.91191614e-01 -8.82264450e-02 -2.66590267e-02  8.59348699e-02\n -8.44974294e-02 -1.02412038e-01  1.02318265e-03 -7.94025734e-02\n  3.17770019e-02  1.56106688e-02  2.74224542e-02  7.33621940e-02\n -9.45560783e-02 -4.00327474e-01 -9.66509059e-02 -1.43014982e-01\n -2.43942812e-03 -1.15434512e-01 -3.63739096e-02  6.95930868e-02\n -1.28410071e-01  1.05237886e-02 -4.69876342e-02  1.42619044e-01\n  2.92818472e-02 -2.06620470e-02  1.76548272e-01 -1.16039701e-02\n -1.13152772e-01 -1.52380481e-01 -1.53028220e-03  2.65979648e-01\n  7.48620033e-02  3.77634913e-02  9.45235882e-03 -3.76373529e-04\n  1.03026003e-01 -2.26060539e-01  3.77640352e-02  1.20116591e-01\n  6.55327886e-02  3.90058681e-02  1.09717079e-01 -7.23294616e-02\n  6.24161065e-02  1.84066221e-03 -1.53249532e-01  2.65484974e-02\n  3.33082676e-03 -6.09994531e-02 -9.08998474e-02 -9.35301185e-03\n  2.44303137e-01  1.23673499e-01 -6.01707697e-02 -9.99149606e-02\n  1.50435984e-01 -2.31457442e-01 -5.46206757e-02  4.82325144e-02\n -6.78365007e-02 -1.57278940e-01 -2.30089590e-01  2.97565460e-02\n  3.37810695e-01  2.23837197e-01 -1.03635594e-01  9.49699581e-02\n -7.96795115e-02 -6.79427832e-02  1.02416292e-01  6.19020686e-02\n -9.93955582e-02  1.09431893e-01 -1.05950080e-01  9.28554982e-02\n  1.53387353e-01 -1.74394250e-03 -2.70584933e-02  1.61084756e-01\n -3.05397697e-02  1.15189299e-01  2.39426382e-02 -5.53814247e-02\n -5.48561066e-02  1.64379328e-02 -9.92272794e-02  1.86441243e-02\n  1.59954041e-01 -4.08504158e-02 -8.70198011e-03  5.71771041e-02\n -2.04707295e-01  8.06034207e-02 -2.59194970e-02 -5.10732457e-02\n  5.24946079e-02  6.59721494e-02 -1.87484413e-01 -4.98244315e-02\n  1.37550399e-01 -2.26042449e-01  1.24106199e-01  1.50619537e-01\n  9.12392139e-03  1.66423917e-01  9.95513573e-02  5.13795391e-02\n  2.90057883e-02 -1.04610734e-01 -1.57394573e-01 -7.54791126e-02\n  6.99397624e-02 -5.37359715e-03  9.78155434e-03 -8.10969248e-03]'}"
    # # known_data = ast.literal_eval(inputdata.replace('\n', ''))
    # print(inputdata)
    # print(type(inputdata))

    # print(known_data.keys())
    # print(getnparray(known_data))

    # sent new face
    # new_face_encoding = face_recognition.face_encodings(face_recognition.load_image_file('''os.path.join(path, file)'''))[0]


    new_face_encoding = toNParray(sys.argv[1].replace('\n', '').replace(',', ''))
    # testing example
    # new_face_encoding = '[-0.09166827  0.14425197  0.04078295 -0.03495655 -0.09622052  0.04099583\n  0.02662841 -0.17784461  0.12904914 -0.1388557   0.18857408 -0.02269836\n -0.31221309 -0.10909825  0.05068425  0.11542154 -0.11377509 -0.12412596\n -0.18914004 -0.11264455 -0.02938333  0.04681868 -0.0251527  -0.04514992\n -0.08941696 -0.25926712 -0.10442628 -0.05142256  0.01757953 -0.08665138\n  0.0842521   0.06147777 -0.20893137 -0.08608527 -0.05323231  0.03884585\n -0.05924495 -0.04575182  0.07029408  0.03683743 -0.14352694 -0.04711682\n -0.02806153  0.23502387  0.23772253  0.01743989 -0.00103552 -0.09930864\n  0.09209329 -0.25414282 -0.02423913  0.10893594  0.04156319  0.1021982\n  0.05787547 -0.09143835  0.01682046  0.13410327 -0.16470394  0.0794233\n  0.04785687 -0.2341857  -0.0453307  -0.06419529  0.09106698  0.08091357\n -0.0099361  -0.13200559  0.22118577 -0.18348159 -0.13668175  0.05446102\n -0.06471929 -0.15043966 -0.3472513   0.00623041  0.37149131  0.18573408\n -0.15642616 -0.05463828 -0.04825759 -0.00336403  0.09292394  0.07982755\n  0.0016217  -0.12219425 -0.07368944  0.03052378  0.25506455 -0.07061901\n -0.0461551   0.24331255 -0.03288478 -0.03834173  0.02473532  0.03230941\n -0.05248236 -0.01390602 -0.09815697 -0.06522249  0.06731446 -0.14231357\n  0.00802742  0.08258242 -0.11984105  0.21042551  0.01114251  0.01666296\n -0.00154421 -0.11873214 -0.02308807  0.06714715  0.23481898 -0.16937561\n  0.25159791  0.23491265 -0.06884868  0.13148509  0.03437761  0.12037931\n -0.06310897 -0.08327458 -0.14112675 -0.16643775  0.02053617  0.02646331\n  0.01319711  0.01977976]'
    # new_face_encoding = toNParray(new_face_encoding)

    # print("got new face encoding")

    # # A picture that has multiple faces
    # rgb_pic = None

    # # Find all the faces and face encodings in the current frame of video
    # face_locations = face_recognition.face_locations(rgb_pic)
    # face_encodings = face_recognition.face_encodings(rgb_pic, face_locations)



    # for face_encoding in face_encodings:
    # See if the face is a match for the known face(s)
    matches = face_recognition.compare_faces(data["encodings"], new_face_encoding, 0.5)
    name = "Unknown"
    # name = "WelcomeStranger"

    # If a match was found in known_face_encodings, just use the first one.
    if True in matches:
        first_match_index = matches.index(True)
        # name = list(known_data.keys())[first_match_index] # name can be swapped with profile_ID
        name = data["names"][first_match_index]

    print(name)
    sys.stdout.flush()

    # with open ('response', 'w') as f:
    #     f.write(name)

except Exception as e: print(e, os.path.abspath(__file__), regex.sub('/models/encodings', os.path.abspath(__file__)), sep='\n')